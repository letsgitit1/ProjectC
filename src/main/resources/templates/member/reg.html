<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>회원가입</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
	<main>
		<h3>회원가입</h3>
		<form action="/reg" method="POST">
			<table class="form-group">
				<tr>
					<th><label for="id">아이디</label></th>
					<td><input type="text" name="email" id="email" required></td>
					<td><span id="idOK"></span> </td>
				</tr>
				<tr>
					<th><label for="password">패스워드</label></th>
					<td><input type="password" name="password" id="password" required></td>
				</tr>
				<tr>
					<th><label for="rname">이름</label></th>
					<td><input type="text" name="username" id="rname" required></td>
				</tr>
				<tr>
					<th><label for="rage">나이</label></th>
					<td><input type="number" name="age" id="rage" required></td>
				</tr>
				<tr>
					<th><label for="rgender">성별</label></th>
					<td>
						<input type="radio" name="gender" id="rgender" value="남성" required>남
    					<input type="radio" name="gender" id="rgender" value="여성" required>여<br>
    				</td>	
				</tr>
				<tr>
					<th><label for="raddress">주소</label></th>
					<td><input type="text" name="address" id="raddress" required></td>
				</tr>
				<tr>
					<th><label for="rphone">전화번호</label></th>
					<td><input type="tel" name="phone_number" id="rphone" required></td>
				</tr>
				<tr>
					<th><label for="rlicense">운전면허</label></th>
					<td><input type="text" name="driver_license_number" id="rlicense" required></td>
				</tr>
				<tr>
					<th><label for="rnickname">닉네임</label></th>
					<td><input type="text" name="name" id="rnickname" required></td>
				</tr>
				<tr>
					<td colspan="3"><button>회원가입</button> <button type="reset">다시입력</button> <button type="button" onclick="location.href='./'">메인</button> </td>
				</tr>
			</table>
		</form>
		
<script type="text/javascript">

//ajax 아이디확인
$('#email').on('keyup', function() {
	   const id = $('#email').val();
	   const xhr = new XMLHttpRequest();
	   const idOK = $('#idOK');

		console.log(id);

	   $.ajax({
	      type: 'post',
	      url: "/check/"+id,
	      dataType: 'json',
	      success: function(response) {
	    	  console.log(response)
	    	  console.log(JSON.parse(response))
	         if (JSON.parse(response) == 0) {
	            idOK.html('사용가능한 아이디입니다.');
	            idOK.css('color', 'green');
	         } else {
	            idOK.html('중복된 아이디입니다.');
	            idOK.css('color', 'red');

	         }
	      },
	      error: function() {
	    		console.log("실패");
	    	}
	   })

	});
</script>
	</main>
</body>
</html>