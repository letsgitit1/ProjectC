<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.mvc.carshare.dao.CCarDao">
 	<!-- 이동해 -->
 	
 	<!-- 내차등록 -->
 	<insert id="carReg" parameterType="CCarVo">
 		INSERT INTO C_CARS
		(car_id, CAR_NUMBER, OWNER_ID, CAR_MODEL, MANUFACTURER, ENGINE_TYPE, CAR_TYPE, C_YEAR)
		VALUES(cars_seq.nextval,#{car_number}, #{owner_id}, #{car_model},
		 #{manufacturer}, #{engine_type}, #{car_type}, #{c_year})
 	</insert>
 	
 	<!-- 등록된 차량 조회 -->
 	<select id="carSel" parameterType="String" resultType="CCarDto">
 		SELECT CAR_NUMBER ,CAR_MODEL ,MANUFACTURER ,ENGINE_TYPE ,CAR_TYPE ,C_YEAR ,driver_License_number, car_image, owner_id,car_id FROM 
		C_CARS cc 
		JOIN C_MEMBERS cm 
		ON cm.ID =cc.OWNER_ID
		WHERE username = #{username}
		order by car_id
 	</select>
 	
 	<!-- 내차 평점 -->
 	<select id="carSc" parameterType="int" resultType="int">
 		SELECT nvl(AVG(CAR_SCORE),0) FROM C_REVIEWS cr 
		WHERE cr.CAR_NUMBER IS NOT NULL AND CAR_NUMBER =#{car_number}
 	</select>
 	
 	<!-- 차 번호 구하기 -->
 	 <select id="getCarNum" parameterType="String" resultType="int">
 		SELECT CAR_ID FROM 
		C_CARS cc 
		JOIN C_MEMBERS cm 
		ON cm.ID =cc.OWNER_ID
		WHERE EMAIl = #{email}
 	</select>
 	
 	
 </mapper>